let formularioDatos,validado=!1,montoTotal=0,carritoDeCompra=[];const usuario={id:null,nombre:"",apellidos:"",datos_de_contacto:{telefono:"",email:"",direccion:"",ciudad:"",departamento:""}};let metodo_pago="",paso=1;const path=window.location.pathname;function iniciarApp(){eventoInputs(),eventoMenu(),agregarFixed(),subrayarPaginaActual(),eventoCarritoUserBoton(),"/"===path&&(eventoCuadros(),consultarApiCuadros()),"/carrito_de_compras"===path&&(crearOpcionesEnSelected(),recuperarCarritoCompras(),tabs(),mostrarSeccion(),agregar_evento_botones_paginacion(),inputMetodosDePago(),formulario_evento())}function contenedorMetodoPagoEvento(){document.querySelectorAll(".contenedor_metodo_pago").forEach((e=>{e.addEventListener("click",(e=>{const o=e.target.dataset.metodoPago;metodo_pago=o,mostrar_informacion_metodo_pago()}))}))}function inputMetodosDePago(){document.querySelectorAll(".input_radio_metodo_pago").forEach((e=>{e.addEventListener("click",(e=>{const o=e.target.dataset.metodoPago;metodo_pago=o,mostrar_informacion_metodo_pago()}))}))}function mostrar_informacion_metodo_pago(){const e=document.createElement("DIV");e.classList.add("contenedor_crear_pedido");const o=document.querySelector(".contenedor_crear_pedido");if(o&&o.remove(),"transferencia"===metodo_pago){const o=document.querySelector("[data-metodo-pago='transferencia'");return e.innerHTML='<button class="boton_crear_pedido boton">Terminar pedido</button>\n            <p class="crear_pedido_descripcion">Listo... Selecciona crear pedido para\n                crear la orden, una vez tengas la orden realizada, solo falta realizar\n                el pago y empezaremos a realizar y despachar tu pedido... ðŸ˜Ž\n            </p>',o.appendChild(e),metodo_pago="transferencia",void document.querySelector(".boton_crear_pedido").addEventListener("click",crear_pedido)}if("pse"===metodo_pago){const o=document.querySelector("[data-metodo-pago='pse'");return e.innerHTML="<p>Todavia no hemos habilitado transferencia PSE... esperalo pronto :D</p>",metodo_pago="pse",void o.appendChild(e)}}function obtenerValueElementById(e){return document.getElementById(e).value}async function crear_pedido(){try{const e=getFechaActualFormateada(),o={carritoDeCompra:carritoDeCompra,pedidos:{fecha:e,direccion:formularioDatos.direccion,monto_total:montoTotal,departamento:formularioDatos.departamento,ciudad:formularioDatos.ciudad,metodo_pago:metodo_pago,informacion_adicional:formularioDatos.informacion_extra},usuario:{nombre:formularioDatos.nombre,apellido:formularioDatos.apellido,email:formularioDatos.email,telefono:formularioDatos.telefono}},t="http://localhost:3000/api/cuadros/crear_orden";jsonData=JSON.stringify(o);const a={method:"POST",body:jsonData};console.log(o);const r=await fetch(t,a),n=await r.json();console.log(n),n.exito&&Swal.fire({icon:"success",title:"Pedido creado",text:"El pedido ha sido guardado con exito",button:"OK"}).then((()=>{mostrar_instrucciones_despues_de_pago(n)}))}catch(e){console.log(e),Swal.fire({icon:"error",title:"Ha habido un error",text:"El pedido no se ha podido crear.."})}}function mostrar_instrucciones_despues_de_pago(e){document.querySelector("main").innerHTML=`\n    <h1>Gracias por tu compra!</h1>\n    <div class="div_instrucciones_pago contenedor">\n    <h2>Instrucciones a seguir</h2>\n    <div class="contenedorInstrucciones">\n        <p>Consigna a nuestra cuenta bancolombia #: <span>412514</span></p>\n        <p>Manda un screenshot a nuestro wp #124123123312 con el pedido # <span>${e.pedidoId}</span></p>\n        <p>Recibe tus productos en la puerta de tu casa...!</p>\n    </div>\n    <div class="resumenCompra"></div>\n    <h2>Resumen de tu pedido</h2>\n    <p>El pedido quedo a nombre de : <span> ${e.nombre} </span>  </p>\n    <p>El costo total a pagar es de : <span> ${parseInt(e.costo_total).toLocaleString()} </span></p>\n    <p>Los productos que te mandaremos son: ....</p>\n    <p>La direccion a la que te mandaremos los productos es: <span>${e.direccion}</span> </p>\n    </div>\n    `}function formulario_evento(){document.getElementById("formulario_carrito_de_compras").addEventListener("submit",(e=>{e.preventDefault();const o=crear_objeto_con_datos_de_formulario(e);validar_formulario_informacion_para_pedido(o).then((e=>{e?(validado=!0,formularioDatos=o,cambiarSeccionAdelante()):validado=!1}))}))}function crear_objeto_con_datos_de_formulario(e){return Object.fromEntries(new FormData(e.target))}async function validar_formulario_informacion_para_pedido(e){try{jsonData=JSON.stringify(e);const o="http://localhost:3000/api/cuadros/validar_formulario",t={method:"POST",body:jsonData};console.log(e);const a=await fetch(o,t),r=await a.json();if(!r.error)return!0;{const e=document.querySelector("#alertas");for(;e.firstChild;)e.removeChild(e.firstChild);r.error.forEach((o=>{const t=document.createElement("P");return t.classList.add("alerta","error"),t.textContent=o,e.appendChild(t),!1}))}}catch(e){const o=document.querySelector("#alertas"),t=document.createElement("P");t.textContent=e,o.appendChild(t)}}function tabs(){document.querySelectorAll(".tabs button").forEach((e=>{e.addEventListener("click",(function(e){if("3"===e.target.dataset.paso){if(!activar_evento_submit_en_formulario_carrito_compras())return}paso=parseInt(e.target.dataset.paso),mostrarSeccion()}))}))}function mostrarSeccion(){let e=document.querySelector(".actual");const o=document.querySelector("#anterior"),t=document.querySelector("#siguiente");if(3===paso){const e=document.querySelector("#alertas");for(;e.firstChild;)e.removeChild(e.firstChild);if(!validado){return void(document.getElementById("alertas").innerHTML="<p class='alerta error'> Faltan datos por rellenar</p>")}console.log("el usuario esta validado, pasando a la seccion 3"),t.classList.add("hidden")}if(e){e.classList.remove("actual"),e.classList.add("ocultar");const o=document.querySelector(".hidden");o&&o.classList.remove("ocultar")}1===paso&&o.classList.add("hidden"),2===paso&&(o.classList.remove("hidden"),t.classList.remove("hidden"));let a=document.querySelector(`#paso-${paso}`);console.log(a,paso),a.classList.add("actual"),a.classList.remove("ocultar")}function crearOpcionesEnSelected(){const e=document.querySelector("#departamento");getDepartamentosColombia().then((o=>{o.forEach((o=>{const t=document.createElement("OPTION");t.textContent=o.name,t.value=o.name,t.dataset.departamentoId=o.id,e.appendChild(t)}))})),e.addEventListener("change",eventoSelect)}function eventoSelect(e){get_ciudades_de_un_departamento(e.target.options[e.target.selectedIndex].attributes["data-departamento-id"].value).then((e=>{crear_options_de_ciudad(e),console.log(e)}))}function crear_options_de_ciudad(e){const o=document.querySelector("#ciudad");e.forEach((e=>{const t=document.createElement("OPTION");t.textContent=e.name,t.value=e.name,t.dataset.ciudadId=e.id,o.appendChild(t)})),o.removeAttribute("disabled")}async function get_ciudades_de_un_departamento(e){try{const o=`https://api-colombia.com/api/v1/Department/${e}/cities`,t=await fetch(o);return await t.json()}catch(e){console.log(e)}}document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));let departamentos={};async function getDepartamentosColombia(){try{const e="https://api-colombia.com/api/v1/Department",o=await fetch(e);return await o.json()}catch(e){console.log(e)}}async function recuperarCarritoCompras(){try{const e="http://localhost:3000/api/cuadros/guardar_carrito_compras",o=await fetch(e),t=await o.json();carritoDeCompra=t.carritoDeCompra,montoTotal=t.montoTotal,mostrarCarritoDeCompras()}catch(e){console.log(e)}}function mostrarCarritoDeCompras(){const e=document.querySelector(".contenedorProductosFormulario"),o=document.querySelector("#tbody");for(;o.firstChild;)o.removeChild(o.firstChild),e.firstChild&&e.removeChild(e.firstChild);if(!carritoDeCompra.length>=1){const o=document.createElement("P");return o.classList.add("parrafoCarritoVacio"),o.innerHTML="El carrito esta vacio ... <br /> Lo sentimos selecciona algo para poder seguir con alguna compra ...  ðŸ˜­",void e.appendChild(o)}const t=document.getElementById("tbody");carritoDeCompra.forEach((e=>{const{id:o,nombre:a,precio:r,descripcion:n,size:c,disponible:i,imagen:d,cantidad:s}=e;document.createElement("DIV").classList.add("interfazCampo");const l=document.createElement("P");l.textContent=a,l.classList.add("nombre-producto");const m=document.createElement("P");m.textContent=`$${parseInt(r).toLocaleString()}`,m.classList.add("precio-producto");const u=document.createElement("P");u.textContent=`Cantidad: ${s}`,u.classList.add("cantidad_producto");const p=document.createElement("BUTTON");p.classList.add("botonChico"),p.textContent="+",p.addEventListener("click",(function(){agregarCantidad(e,!0)}));const C=document.createElement("BUTTON");C.classList.add("botonChicoRojo"),C.textContent="-",C.addEventListener("click",(function(){restarCantidad(e,!0)}));const f=document.createElement("P");f.innerHTML=`<span>TamaÃ±o: </span> ${c}`;const h=document.createElement("P");h.classList.add("descripcion-producto"),h.textContent=n;const g=document.createElement("DIV");g.classList.add("iconoDiv");const _=document.createElement("I");_.classList.add("fa-solid","fa-trash"),_.dataset.idProducto=o,_.addEventListener("click",(function(e){eliminarProducto(e.target.dataset.idProducto)})),g.appendChild(_);const v=document.createElement("DIV");v.classList.add("infoProductoCarrito"),v.appendChild(l),v.appendChild(f),v.appendChild(h);const E=document.createElement("DIV");E.classList.add("cantidad_producto_div"),E.appendChild(p),E.appendChild(C),E.appendChild(g);const L=document.createElement("IMG");L.src=`/img/${d}`;const D=r*s,b=document.createElement("P");b.textContent=`$${D.toLocaleString()}`,b.classList.add("precio-total-produto");const S=document.createElement("TR"),y=document.createElement("TD");y.classList.add("tabla_DetallesDelProducto"),y.appendChild(L),y.appendChild(v);const T=document.createElement("TD");T.appendChild(u),T.appendChild(E);const I=document.createElement("TD");I.appendChild(m);const P=document.createElement("TD");P.appendChild(b),S.appendChild(y),S.appendChild(T),S.appendChild(I),S.appendChild(P),t.appendChild(S)}));const a=document.createElement("P");a.classList.add("parrafoMontoTotal"),montoTotal=sumarProductosCarrito(),a.innerHTML=`<span>Monto Total:</span> $${montoTotal.toLocaleString()} COP`,e.appendChild(a)}function agregar_evento_botones_paginacion(){anterior=document.querySelector("#anterior"),siguiente=document.querySelector("#siguiente"),siguiente.addEventListener("click",cambiarSeccionAdelante),anterior.addEventListener("click",cambiarSeccionAtras)}function activar_evento_submit_en_formulario_carrito_compras(){const e=document.getElementById("formulario_carrito_de_compras"),o=new Event("submit",{bubbles:!0,cancelable:!0});e.dispatchEvent(o)}function cambiarSeccionAdelante(e){(2!==paso||(activar_evento_submit_en_formulario_carrito_compras(),validado))&&3!==paso&&(paso++,mostrarSeccion())}function cambiarSeccionAtras(){1!==paso&&(paso--,mostrarSeccion())}function eliminarProducto(e){carritoDeCompra.forEach((o=>{if(o.id===e){const e=carritoDeCompra.indexOf(o.id);carritoDeCompra.splice(e,1),console.log(carritoDeCompra),mostrarCarritoDeCompras()}}))}async function guardar_carrito_en_session(){try{const e=getFechaActualFormateada(),o={carritoDeCompra:carritoDeCompra,userData:{usuarioID:usuario.id},fecha:e,status:"pendiente",monto_total:montoTotal,metodo_pago:metodo_pago},t="http://localhost:3000/api/cuadros/guardar_carrito_compras";jsonData=JSON.stringify(o);const a={method:"POST",body:jsonData};console.log(o);const r=await fetch(t,a),n=await r.json();console.log(n),n.resultado&&Swal.fire({icon:"success",title:"Pedido creado correctamente",text:"El pedido ah sido creado crrectamente, a continuacion lee lo siguiente",button:"OK"}).then((()=>{window.location.href="/carrito_de_compras"}))}catch(e){console.log(e),Swal.fire({icon:"error",title:"Ha habido un error",text:"El pedido no se ha podido crear.."})}}function getFechaActualFormateada(){const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}async function consultarApiCuadros(){try{const e="http://localhost:3000/api/cuadros",o=await fetch(e);imprimirResultadosApi(await o.json())}catch(e){console.log(e)}}function imprimirResultadosApi(e){e.forEach((e=>{const{descripcion:o,disponible:t,id:a,imagen:r,nombre:n,precio:c,size:i}=e,d=document.getElementById("cuadros"),s=document.createElement("DIV");s.classList.add("cuadro");const l=document.createElement("DIV");l.classList.add("imagenCuadroDiv"),l.style.backgroundImage=`url(/img/${r})`;const m=document.createElement("DIV");m.classList.add("cuadro-info"),m.dataset.idCuadro=a;const u=document.createElement("P");u.classList.add("nombre-cuadro"),u.textContent=n;const p=document.createElement("P");p.classList.add("precio-cuadro"),p.textContent=c,m.appendChild(u),m.appendChild(p),crearBotonComprarActual(m,e),l.appendChild(m),s.appendChild(l),d.appendChild(s)}))}function eventoCuadros(){cuadros=document.querySelectorAll(".imagenCuadroDiv"),cuadros.forEach((e=>{e.addEventListener("mouseenter",crearBotonComprar),e.addEventListener("mouseleave",eliminarBotonComprar)}))}function crearBotonComprarActual(e,o){const t=document.createElement("DIV"),a=document.createElement("BUTTON");a.classList.add("boton"),a.textContent="Agregar al carrito",t.appendChild(a),e.appendChild(t),a.addEventListener("click",(function(){agregarAlCarrito(o)}))}function agregarAlCarrito(e){if("cantidad"in e){const{id:o}=e;let t;carritoDeCompra.forEach((e=>{o===e.id&&(t=e)}));const a=carritoDeCompra.indexOf(t);carritoDeCompra[a].cantidad=carritoDeCompra[a].cantidad+1}else e.cantidad=1,carritoDeCompra.push(e);actualizarInterfazCarritoCompra()}function removeInterfazDinamico(e,o){o.remove(),e.target.removeEventListener("click",removeInterfaz)}function eventoCarritoUserBoton(){const e=document.querySelector(".carritoCompra"),o=document.querySelector(".userBoton");e.addEventListener("click",mostrarInterfazCarritoCompras),o.addEventListener("click",mostrarInterfazCarritoCompras)}function mostrarInterfazCarritoCompras(){actualizarInterfazCarritoCompra();const e=document.querySelector(".modalCarrito"),o=document.querySelector("#carritoDeCompras");e.appendChild(o),esconderScroll()}function actualizarInterfazCarritoCompra(){const e=document.querySelector(".modalCarrito");e&&e.remove(),crearModal();const o=document.querySelector(".contenedorCarritoCompras");if(!carritoDeCompra.length>=1){const e=document.createElement("P");return e.classList.add("parrafoCarritoVacio"),e.textContent="El carrito esta vacio ...",void o.appendChild(e)}for(;o.firstChild;)o.removeChild(o.firstChild);carritoDeCompra.forEach((e=>{const{id:t,nombre:a,precio:r,descripcion:n,size:c,disponible:i,imagen:d,cantidad:s}=e,l=document.createElement("DIV");l.classList.add("interfazCampo");const m=document.createElement("P");m.textContent=a,m.classList.add("nombre-producto");const u=document.createElement("P");u.textContent=r,u.classList.add("precio-producto");const p=document.createElement("P");p.textContent=`Cantidad: ${s}`;const C=document.createElement("BUTTON");C.classList.add("botonChico"),C.textContent="+",C.addEventListener("click",(function(){agregarCantidad(e)}));const f=document.createElement("BUTTON");f.classList.add("botonChicoRojo"),f.textContent="-",f.addEventListener("click",(function(){restarCantidad(e)}));const h=document.createElement("DIV");h.classList.add("infoProductoCarrito"),h.appendChild(m),h.appendChild(u),h.appendChild(p),h.appendChild(C),h.appendChild(f),crearBotonBorrar(h,t,e);const g=document.createElement("IMG");g.src=`/img/${d}`,l.appendChild(h),l.appendChild(g),o.appendChild(l)}));const t=document.createElement("P");t.classList.add("parrafoMontoTotal"),montoTotal=sumarProductosCarrito(),t.textContent=`Monto Total: $${montoTotal.toLocaleString()} pesos Colombianos`,o.appendChild(t);const a=document.createElement("BUTTON");a.classList.add("botonComprar"),a.textContent="Comprar",a.addEventListener("click",guardar_carrito_en_session),o.appendChild(a)}function sumarProductosCarrito(){let e=0;return carritoDeCompra.forEach((o=>{let t=parseInt(o.precio)*o.cantidad;e+=t})),e}function actualizar_resumen_de_carrito_compras(){}function agregarCantidad(e,o=!1){const t=carritoDeCompra.indexOf(e);carritoDeCompra[t].cantidad++,o?mostrarCarritoDeCompras():actualizarInterfazCarritoCompra()}function restarCantidad(e,o=!1){const t=carritoDeCompra.indexOf(e);carritoDeCompra[t].cantidad--,carritoDeCompra[t].cantidad<1&&borrarProductoDeCarritoDeCompra(e.id,e),o?mostrarCarritoDeCompras():actualizarInterfazCarritoCompra()}function crearModal(){esconderScroll();const e=document.createElement("DIV");e.classList.add("modal","modalCarrito"),ocultarHeader(),e.addEventListener("click",ocultarModal);const o=document.querySelector("body"),t=document.createElement("DIV");t.id="carritoDeCompras",t.innerHTML='\n    <div class="contenedorCarritoCompras"></div>\n    ',e.appendChild(t),o.appendChild(e)}function crearBotonBorrar(e,o,t){const a=document.createElement("BUTTON");a.classList.add("botonBorrar"),a.textContent="Elimina el producto",e.appendChild(a),a.addEventListener("click",(function(){carritoDeCompra.forEach((e=>{if(e.id===o){const o=carritoDeCompra.indexOf(e);carritoDeCompra.splice(o,1),delete t.cantidad,actualizarInterfazCarritoCompra()}}))}))}function borrarProductoDeCarritoDeCompra(e,o){carritoDeCompra.forEach((t=>{if(t.id===e){const e=carritoDeCompra.indexOf(t);carritoDeCompra.splice(e,1),delete o.cantidad,actualizarInterfazCarritoCompra()}}))}function ocultarModal(e){const o=document.querySelector(".modalCarrito");eventClass=e.target.closest(".contenedorCarritoCompras"),eventClass||(mostrarScroll(),o.remove(),mostrarHeader())}function mostrarScroll(){document.querySelector("body").style.overflowY="scroll"}function esconderScroll(){document.querySelector("body").style.overflowY="hidden"}function eventoMenu(){menu=document.querySelector(".hamburgerMenu"),menu.addEventListener("click",(function(){mostrarModal()}))}function mostrarModal(){ocultarHeader(),botonCerrar=document.querySelector(".icono"),modal=document.querySelector(".modal"),modal.classList.remove("ocultar"),modal.addEventListener("click",ocultarModalAndMostrarHeader)}function ocultarModalAndMostrarHeader(e){eventClass=e.target.closest(".menu"),eventClass||(modal.classList.add("ocultar"),mostrarHeader(),modal.removeEventListener("click",ocultarModalAndMostrarHeader))}function subrayarPaginaActual(){paginaActual=obtenerPaginaActual(),menuCampos=document.querySelectorAll(".menuCampo a"),menuCampos.forEach((e=>{e.attributes.href.value===paginaActual&&e.classList.add("subrayarAmarillo")}))}function obtenerPaginaActual(){return window.location.pathname}function ocultarHeader(){header=document.querySelector("header"),header.classList.add("ocultar")}function mostrarHeader(){header=document.querySelector("header"),header.classList.remove("ocultar")}function agregarFixed(){header=document.querySelector(".header"),sectionReferencia=document.querySelector(".nombre-pagina"),document.addEventListener("scroll",(function(){sectionReferencia.getBoundingClientRect().top<1?header.classList.add("positionFixed"):header.classList.remove("positionFixed")}))}function eventoInputs(){inputBoton=document.querySelectorAll("[name='user[contacto]']"),inputBoton.forEach((function(e){e.addEventListener("click",(function(e){target=e.target.id,mostrar(target)}))}))}function mostrar(e){div=document.querySelector(".contactoDiv"),"byTelefono"===e&&(div.innerHTML='\n        <label for="telefono">Numero de Celular</label>\n        <input id="telefono" type="tel" placeholder="Tu numero de celular" name="user[telefono]">\n        '),"byEmail"===e&&(div.innerHTML='\n        <label for="email">Correo</label>\n        <input id="email" type="email" placeholder="Tu correo electronico" name="user[email]">\n        ')}
//# sourceMappingURL=app.js.map
