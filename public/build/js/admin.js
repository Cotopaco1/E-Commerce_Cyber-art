import{activar_evento_submit_by_id,capturar_y_verificar_datos_de_formulario,crear_alerta_de_cargando,eliminar_alerta_de_cargando}from"./helper.js";document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));let productos_json={};function iniciarApp(){mostrarDatosResumen(),eventosBotones(),eventos_botones_menu()}function eventos_botones_menu(){document.querySelector("#home").addEventListener("click",actualizarPagina),document.querySelector("#productos").addEventListener("click",mostrarProductos),document.querySelector("#nuevo_producto").addEventListener("click",mostrar_crear_producto)}function eventosBotones(){document.querySelector("#boton_pedidos").addEventListener("click",mostrarPedidos),document.querySelector("#boton_productos").addEventListener("click",mostrarProductos)}function mostrarPedidos(){console.log("mostrando productos...")}function mostrar_crear_producto(){insertar_formulario_crear(),cambiarTitulo("Crear Producto"),document.querySelector(".formulario").addEventListener("submit",evento_formulario_crear)}async function evento_formulario_crear(e){e.preventDefault();const o=new FormData(e.target);try{const e=`${location.origin}/api/admin/crear_producto`,t={method:"post",body:o};crear_alerta_de_cargando();const n=await fetch(e,t),a=await n.json();if(eliminar_alerta_de_cargando(),a.resultado)Swal.fire({title:"Buen trabajo!",text:`${a.mensaje}`,icon:"success",fontsize:"5rem"}).then(mostrarProductos);else{console.log(a);const e=document.getElementById("mensaje_error");e.innerHTML="",a.alertas.forEach((o=>{const t=document.createElement("P");t.textContent=o,e.appendChild(t)}))}}catch(e){console.log(e)}}function insertar_formulario_crear(){document.querySelector(".contenido").innerHTML='\n     <form class="producto_div formulario crear_producto" id="formulario" enctype="multipart/form-data">\n                <div class="informacion_producto ">\n                    <label htmlFor="nombre_editar">Nombre: <input name="nombre" id="nombre_editar" type="text" /></label>\n                    <label >Precio: <input name="precio" id="precio_editar" type="text"/></label>\n                    <label htmlFor="">\n                    Disponible:\n                    <select id="select_disponible" name="disponible">\n                        <option value="1">Si</option>\n                        <option value="0">No</option>\n                    </select>\n                    </label>\n                    <label htmlFor="">Tamaño: <input type="text" name="size" /></label>\n                </div>\n           \n            <div class="div_producto_dos">\n                <input type="file" name="imagen" />\n                 <label for="descripcion" >Descripcion:</label>\n                  <textarea name="descripcion" id="descripcion" placeholder="Escribe la descripcion" ></textarea>\n            </div>\n        <div id="mensaje_error"></div>\n        <div class="producto_div_footer">\n            <input type="submit" value="Crear producto" id="crear_producto" class="boton-ver" />\n            \n        </div>\n    </form>\n    '}function evento_botones_action(){document.querySelectorAll(".boton-editar").forEach((e=>{e.addEventListener("click",mostrar_editar_producto)})),document.querySelectorAll(".boton-ver").forEach((e=>{e.addEventListener("click",mostrar_ver_producto)})),document.querySelectorAll(".boton-eliminar").forEach((e=>{e.addEventListener("click",eliminar_producto)}))}async function eliminar_producto(e){const o={id:e.target.dataset.id};try{const e={method:"POST",body:JSON.stringify(o)},t=await fetch("/api/admin/eliminar_producto",e),n=await t.json();n.resultado?Swal.fire({title:"Buen trabajo!",text:`${n.mensaje}`,icon:"success",fontsize:"5rem"}).then(mostrarProductos):Swal.fire({title:"Error!",text:`${n.mensaje}`,icon:"error",fontsize:"5rem"})}catch(e){}}function mostrar_ver_producto(e){const o=e.target.dataset.id,t=productos_json.find((function(e){return e.id===o}));crearModal(),insertar_al_modal_producto_ver(t)}function insertar_al_modal_producto_ver(e){const{descripcion:o,disponible:t,id:n,imagen:a,nombre:r,precio:i,size:c}=e;document.querySelector(".contenido_modal").innerHTML=`\n    <div class="producto_div">\n            <div class="div_producto_uno">\n                <div class="imagen_producto_div">\n                    <img src="/img/productos/${a}" alt="imagenProducto" />\n                    \n                </div>\n                <div class="informacion_producto">\n                    <p >ID: <span>${n}</span></p>\n                    <p>Nombre: <span>${r}</span></p>\n                    <p>Precio: <span>${i}</span></p>\n                    <p>Tamaño: <span>${c}</span></p>\n                    <label htmlFor="">\n                    Disponible:\n                    <select disabled id="select_disponible" name="disponible">\n                        <option value="1">Si</option>\n                        <option value="0">No</option>\n                    </select>\n                    </label>\n                </div>\n            </div>\n            <div class="div_producto_dos">\n                 <p for="descripcion" ><span>Descripcion:</span></p>\n                  <textarea name="descripcion" id="descripcion" disabled>${o}</textarea>\n            </div>\n        <div class="producto_div_footer">\n            <button class="boton-eliminar" id="cancelar_boton">Volver</button>\n        </div>\n    </div>\n    `;document.getElementById("select_disponible").value=t;document.getElementById("cancelar_boton").addEventListener("click",eliminarModal)}function mostrarProductos(){cambiarTitulo("Productos"),crearTabla(),solicitud_get_por_url("http://localhost:3000/api/cuadros/getcuadros").then(llenarAndMostrarTablaProductos)}function cambiarTitulo(e){document.querySelector(".titulo_app").innerHTML=`<h1>${e}</h1>`}function crearTabla(e=[]){document.querySelector(".contenido").innerHTML='\n    <table class="tablaResumen id="tabla">\n    <thead>\n            <tr>\n                <td>Imagen</td>\n                <td>Nombre</td>\n                <td>Precio</td>\n                <td>Actions</td>\n            </tr>\n        </thead>\n        <tbody id="tbody">\n        \n        </tbody>\n    </table>\n    '}function llenarAndMostrarTablaProductos(e){const o=document.getElementById("tbody");productos_json=e,e.forEach((e=>{const{descripcion:t,disponible:n,id:a,imagen:r,nombre:i,precio:c,size:d}=e,l=document.createElement("TR");l.innerHTML=`\n        <td><img src="/img/productos/${r}" alt="imagenProducto" /></td>\n        <td><p>${i}</p></td>\n        <td><p>$<span>${parseInt(c).toLocaleString()}</span></p></td>\n        <td>\n            <div class="actions">\n                <button data-id="${a}" class="boton-editar">Editar</button>\n                <button data-id="${a}" class="boton-ver">Ver</button>\n                <button data-id="${a}" class="boton-eliminar">Eliminar</button>\n            </div>\n        </td>\n        `,o.appendChild(l)})),evento_botones_action()}async function solicitud_get_por_url(e){try{const o=await fetch(e);return await o.json()}catch(e){console.log(e)}}function mostrar_editar_producto(e){const o=e.target.dataset.id,t=productos_json.find((function(e){return e.id===o}));crearModal(),insertar_al_modal_producto(t),document.querySelector(".formulario").addEventListener("submit",evento_formulario_actualizar)}async function evento_formulario_actualizar(e){e.preventDefault();const o=new FormData(e.target);try{const e=`${location.origin}/api/admin/actualizar_producto`,t={method:"post",body:o};crear_alerta_de_cargando();const n=await fetch(e,t),a=await n.json();if(eliminar_alerta_de_cargando(),a.resultado)Swal.fire({title:"Buen trabajo!",text:`${a.mensaje}`,icon:"success",fontsize:"5rem"}).then(eliminar_modal_and_mostrar_productos);else{const e=document.getElementById("mensaje_error");e.innerHTML="",a.alertas.forEach((o=>{const t=document.createElement("P");t.textContent=o,e.appendChild(t)}))}}catch(e){console.log(e)}}function eliminar_modal_and_mostrar_productos(){eliminarModal(),mostrarProductos()}function insertar_al_modal_producto(e){const{descripcion:o,disponible:t,id:n,imagen:a,nombre:r,precio:i,size:c}=e;document.querySelector(".contenido_modal").innerHTML=`\n    <form class="producto_div formulario" id="formulario" enctype="multipart/form-data">\n        \n            <div class="div_producto_uno">\n                <div class="imagen_producto_div">\n                    <img src="/img/productos/${a}" alt="imagenProducto" />\n                    \n                </div>\n                <div class="informacion_producto">\n                    <label htmlFor="">ID: ${n}</label>\n                    <input type="hidden" name="id" value="${n}" />\n                    <label htmlFor="nombre_editar">Nombre: <input name="nombre" id="nombre_editar" type="text" value="${r}" /></label>\n                    <label >Precio: <input name="precio" id="precio_editar" type="text" value="${i}" /></label>\n                    <label htmlFor="">\n                    Disponible:\n                    <select id="select_disponible" name="disponible">\n                        <option value="1">Si</option>\n                        <option value="0">No</option>\n                    </select>\n                    </label>\n                    <label htmlFor="">Tamaño: <input type="text" name="size" value="${c}" /></label>\n                </div>\n            </div>\n            <div class="div_producto_dos">\n                <input type="file" name="imagen" value="${a}" />\n                 <label for="descripcion" >Descripcion:</label>\n                  <textarea name="descripcion" id="descripcion" >${o}</textarea>\n            </div>\n        <div id="mensaje_error"></div>\n        <div class="producto_div_footer">\n            <input type="submit" value="Actualizar Datos" id="actualizar_datos" class="boton-ver" />\n            <button class="boton-eliminar" id="cancelar_boton">Cancelar</button>\n        </div>\n    </form>\n    `;document.getElementById("select_disponible").value=t;document.getElementById("cancelar_boton").addEventListener("click",eliminarModal)}function crearModal(){const e=document.createElement("DIV");e.classList.add("modal"),e.innerHTML='\n    <div class="contenido_modal"></div>\n    ',e.addEventListener("click",evento_para_cerrar_modal);document.querySelector("body").appendChild(e)}function evento_para_cerrar_modal(e){e.target.closest(".producto_div")||eliminarModal()}function eliminarModal(){document.querySelector(".modal").remove()}function mostrarDatosResumen(){getDatosResumen().then(imprimirDatosResumen)}function imprimirDatosResumen(e){document.querySelector("#numero_pedidos span").textContent=e.respuesta.cantidad_pedidos;document.querySelector("#numero_productos span").textContent=e.respuesta.cantidad_productos;document.querySelector("#numero_usuarios span").textContent=e.respuesta.cantidad_usuarios}async function getDatosResumen(){try{const e="http://localhost:3000/api/admin/get_info_resumen",o=await fetch(e);return await o.json()}catch(e){console.log(e)}}function actualizarPagina(){location.reload()}
//# sourceMappingURL=admin.js.map
